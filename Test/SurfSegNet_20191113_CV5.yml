network: SurfSegNet
# train Unet + D2C + SM Module

unary_network: 
  depth: 5
  start_filters: 8
  up_mode: "bilinear"
  resume_path: ""
pair_network:
  depth: 5
  start_filters: 32
  up_mode: "bilinear"
  col_len: 496
  fc_inter: 128
  left_nbs: 50
  resume_path: ""
  window_size: 11
surf_net:
  unary_pretrain_path: "/home/hxie1/data/OCT_Beijing/netParameters/SurfNSBNet2019113/CV5/model_best.pth.tar"
  unary_pretrain_sub: True    # use saved model trained by NSB module, it needs to strip state dict wrapper.
  unary_network: UNet
  pair_pretrain_path: ""
  resume_path: "/home/hxie1/data/OCT_Beijing/netParameters/SurfNet2019113/CV5/model_best.pth.tar"
  wt_init: 0.2     #as unary item has a scale at about 0.06, wt_init=0.02 maybe a good choice.
  updateW: False   # if False, W will not update in SM Module;
surf: [1]
learning: 
  checkpoint_path: "/home/hxie1/data/OCT_Beijing/netParameters/SurfNet2019113/CV5"
  resume_path: ""
  loss: L1Loss
  best_loss: 99999
  batch_size: 24  #48 is too big for Beijing data
  optimizer: Adam
  lr_unary: 0.00001
  lr_pair: 0.001
  epoch_start: 0
  total_iterations: 10
  unary_iterations: 100
  pair_iterations: 20  # use for smooth model optimization
  augmentation: [
                "saltpepper", 
                "Gaussian",
                "cropresize", 
                "circulateud",
                "mirrorlr"
                ]
  data:
    tr_img: "/home/hxie1/data/OCT_Beijing/numpy/training/images_CV5.npy"
    val_img: "/home/hxie1/data/OCT_Beijing/numpy/validation/images_CV5.npy"
    tr_gt: "/home/hxie1/data/OCT_Beijing/numpy/training/surfaces_CV5.npy"
    val_gt: "/home/hxie1/data/OCT_Beijing/numpy/validation/surfaces_CV5.npy"
    tr_ratio: 1.
test:
  mode: False
  data:
    img: "/home/hxie1/data/OCT_Beijing/numpy/test/images_CV5.npy"
    gt: "/home/hxie1/data/OCT_Beijing/numpy/test/surfaces_CV5.npy"
  loss: L1Loss
  batch_size: 1
  pred_dir: "/home/hxie1/data/OCT_Beijing/netParameters/SurfNet2019113/CV5/predict"
  # referenced xml seg file directory
  refXML_dir: "/home/hxie1/data/OCT_Beijing/Correcting_Seg"
